\documentclass{beamer}

% Add
%  -- generation of authentication key (H)
%  -- field & ring definitions

\usepackage{graphicx}
\usepackage[utf8]{inputenc}

\title{GCM; The illegal attack}
\author{Mathias Hall-Andersen (rot256)}
\institute{Pwnies @ Copenhagen University}
\date{2017}

\begin{document}

\frame{\titlepage}

\begin{frame}
\frametitle{Before we start : Get Sage}

\textbf{Fill your disk} \\
\texttt{docker pull sagemath/sagemath}
\url{https://www.sagemath.org/}

\vspace{3mm}

\textbf{Or, sign up at} \\
\url{https://cocalc.com/}

\end{frame}

\begin{frame}
\frametitle{Mode of operation}
\begin{center}
\includegraphics[height=0.5\textheight]{block_cipher.png}
\end{center}
\end{frame}

\begin{frame}
\frametitle{Mode of operation}
\begin{center}
\includegraphics[width=\textwidth]{mode-ecb.png}
\end{center}
\end{frame}

\begin{frame}
\frametitle{Mode of operation}
\begin{center}
\includegraphics[width=\textwidth]{mode-ctr.png}
\end{center}
\end{frame}

\begin{frame}
\frametitle{Authenticated encryption}
\begin{center}
Encryption $\neq$ Authentication
\end{center}
\end{frame}

\begin{frame}
\frametitle{Galois Counter Mode (motivation)}
\begin{center}
\includegraphics[height=0.7\textheight]{mode-gcm.png}
\end{center}
\end{frame}

\begin{frame}
\frametitle{Galois Counter Mode (motivation)}
\begin{center}
\includegraphics[height=0.7\textheight]{mode-gcm.png}
\end{center}
So what is $mult_{H}(\cdot)$?
\end{frame}

\begin{frame}
\frametitle{Some algebra}
\begin{center}
$mult_{H}(\cdot)$ is multiplication by $H$, \\
but not quite the way you might think...
\end{center}
\end{frame}

\begin{frame}
\frametitle{Rings}
\[
    (E, \cdot, +)
\]
St.
\[
    e_{1} \cdot (e_{2} + e_{3})
    =
    e_{1} \cdot e_{2}
    +
    e_{1} \cdot e_{3}
\]
\[
    \forall e_{1} :
    \exists e_{2} :
    e_{1} + e_{2} = 0
\]
Examples:
\[
    \mathbb{Z}
\]
\end{frame}

\begin{frame}
\frametitle{Fields}
\[
    (E, \cdot, +, 0, 1)
\]
Ring + multiplicative inverses, e.i.
\[
    \forall x \exists y : x \cdot y = 1
\]
Usually denote $y = x^{-1}$. Examples:
\[
    \mathbb{Q}, \mathbb{R}
\]
\end{frame}

\begin{frame}
\frametitle{Finite fields}
We will primarily be dealing with the field of two elements:
$1, 0$ \\
Where:
\begin{align}
    1 \cdot x &= x \text{ : 1 is the multiplicative identity} \\
    0 + x     &= x \text{ : 0 is the additive identity} \\
    1 + 1     &= 0 \text{ : the field has characteristic 2}
\end{align}
No magic.
Question:
If considered like bits, what common operations does
addition and multiplication in the field correspond to?
What implication does it have for bit-slicing techniques?
\end{frame}

\begin{frame}
\frametitle{Polynomials over fields}
Given a field. We may consider the polynomials over the field. \\
E.g. for\ GF(2):
\[
    f(x) = x^{7} + x^{4} + x^{1} + 1
\]
\[
    g(x) = x^{6} + x^{3}
\]
We write this as $\mathbb{F}[x]$
\end{frame}

\begin{frame}
\frametitle{Multiplication of polynomials over GF(2)}
Lets focus on GF(2)[x].

\vspace{3mm}

Addition happens coefficient wise
and multiplication also happens as you would expect:
\[
    f(x) = x^{7} + x^{4} + x^{1} + 1
\]
\[
    g(x) = x^{6} + x^{3}
\]
\[
    f(x) \cdot g(x)
    =
    x^{6} f(x) +
    x^{3} f(x)
    = (x^{13} + x^{10} + x^{7} + x^{6})
    + (x^{10} + x^{7} + x^{4} + x^{3})
\]
\[
    = x^{13} + x^{6} + x^{4} + x^{3}
\]
Question: Recall the definition! Is this a ring?
\end{frame}

\begin{frame}
\frametitle{Multiplication of polynomials over GF(2)}
Lets focus on GF(2)[x].

\vspace{3mm}

\[
    f(x) = x^{7} + x^{4} + x^{1} + 1
\]
\[
    g(x) = x^{6} + x^{3}
\]
Question: We can represent the polynomials as bit strings,
e.g.
$f(x) \sim 10010011$,
$g(x) \sim 01001000$ what does xor of bit strings correspond to in the ring?
What does left shifting of bit strings correspond to?
\end{frame}

\begin{frame}
\frametitle{From GF(2)[x] to GF($2^{128}$)}

Take my word for it:
We can transform the ring of polynomials into a field by reducing
modulo a particular class of polynomials in the ring, so called `primitive' polynomials.

\vspace{3mm}

For instance $GF(2)[x] \to GF(2^{4})$, by reducing modulo $x^{2} + 1$:
Since $ f = (x^{5} + x^{3} + x^{2} + x + 1) (x^{2} + 1)$, $f \cong 0 \mod x^{2} + 1$
$ g = (x^{4} + x^{2} + x + 1) \cdot (x^{2} + 1) + (x + 1)$, $g \cong x + 1 \mod x^{2} + 1$

\end{frame}

\begin{frame}
\frametitle{From GF(2)[x] to GF($2^{128}$)}
Reduction in GF(2)[x] / p(x). Easy!
\end{frame}

\begin{frame}
\frametitle{Additional resources}
So $mult_{H}(\cdot) : GF(2^{128}) \to GF(2^{128})$ \\
\vspace{3mm}
\textbf{Courses}
\begin{itemize}
    \item Algebra 1 @ Department of Mathematical Sciences (UCPH)
    \item Algebra 2 @ Department of Mathematical Sciences (UCPH)
    \item Computational Discrete Math @ DTU
\end{itemize}
\textbf{Books}
\begin{itemize}
    \item Algebra (2nd Edition) : Micheal Artin
    \item Abstract Algebra : Dummit \& Foote
\end{itemize}
Break?
\end{frame}

\begin{frame}
\frametitle{Galois Counter Mode (MAC calculation)}
\end{frame}

\begin{frame}
\frametitle{SageMath}
`SageMath is a free open-source mathematics software system licensed under the GPL.
 It builds on top of many existing open-source packages:
 NumPy, SciPy, matplotlib, Sympy, Maxima, GAP, FLINT, R and many more'
 - \url{https://www.sagemath.org/}
\end{frame}

\begin{frame}
\frametitle{SageMath}
sage or go to \url{https://cocalc.com/app}
\end{frame}


\begin{frame}
\frametitle{Nonce reuse attack}
Theorists care about proofs. \\
Pragmatists care about assumptions.
\end{frame}

\begin{frame}
\frametitle{Work session}
\end{frame}

\end{document}
